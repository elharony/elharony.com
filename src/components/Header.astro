---
// Header component with scroll-based transparency
---

<header id="main-header" class="fixed top-0 left-0 right-0 z-50 transition-all duration-300 ease-in-out opacity-0 pointer-events-none">
  <nav class="container mx-auto px-6 py-4">
    <div class="flex items-center justify-between">
      
      <!-- Logo -->
      <div class="flex items-center">
        <a href="/" class="flex items-center space-x-3">
          <img 
            src="/images/logos/Yahya-Elharony-Logo.png" 
            alt="Yahya Elharony Logo" 
            class="w-32 h-12 object-contain drop-shadow-sm"
          />
        </a>
      </div>

      <!-- Desktop Navigation -->
      <div class="hidden md:flex items-center space-x-8">
        <a href="/" class="nav-link text-[#d2d2d2] hover:text-[#3212d3] transition-colors duration-200 font-medium">
          Home
        </a>
        <a href="/blog" class="nav-link text-[#d2d2d2] hover:text-[#3212d3] transition-colors duration-200 font-medium">
          Blog
        </a>
        <a href="/contact" class="nav-link text-[#d2d2d2] hover:text-[#3212d3] transition-colors duration-200 font-medium">
          Contact
        </a>
        <button 
          class="btn-primary bg-[#3212d3] hover:bg-[#1e1b69] text-white px-6 py-2 rounded-lg font-semibold transition-all duration-200 open-booking-modal"
        >
          Book a Strategy Call
        </button>
      </div>

      <!-- Mobile Menu Button -->
      <button id="mobile-menu-button" class="md:hidden text-[#d2d2d2] hover:text-[#3212d3] transition-colors duration-200">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </div>

    <!-- Mobile Navigation -->
    <div id="mobile-menu" class="md:hidden mt-4 pb-4 pt-4 border-t border-[#d2d2d2]/20 hidden">
      <div class="flex flex-col space-y-4">
        <a href="/" class="nav-link text-[#d2d2d2] hover:text-[#3212d3] transition-colors duration-200 font-medium">
          Home
        </a>
        <a href="/blog" class="nav-link text-[#d2d2d2] hover:text-[#3212d3] transition-colors duration-200 font-medium">
          Blog
        </a>
        <a href="/contact" class="nav-link text-[#d2d2d2] hover:text-[#3212d3] transition-colors duration-200 font-medium">
          Contact
        </a>
        <button 
          class="btn-primary bg-[#3212d3] hover:bg-[#1e1b69] text-white px-6 py-2 rounded-lg font-semibold transition-all duration-200 inline-block text-center open-booking-modal"
        >
          Book a Strategy Call
        </button>
      </div>
    </div>
  </nav>
</header>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const header = document.getElementById('main-header');
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    const navLinks = document.querySelectorAll('.nav-link');

    // Mobile menu toggle
    mobileMenuButton.addEventListener('click', function() {
      mobileMenu.classList.toggle('hidden');
    });

    // Close mobile menu when clicking on a link
    navLinks.forEach(link => {
      link.addEventListener('click', function() {
        mobileMenu.classList.add('hidden');
      });
    });

    // Scroll-based header styling
    function updateHeaderOnScroll() {
      const scrollY = window.scrollY;
      const heroSection = document.querySelector('section');
      const heroHeight = heroSection ? heroSection.offsetHeight : 0;
      
      // If we've scrolled past the hero section or more than 100px
      if (scrollY > 100 || scrollY > heroHeight * 0.8) {
        // Add scrolled class for white background
        header.classList.add('scrolled');
        header.classList.remove('transparent');
        
        // Update text colors to dark
        navLinks.forEach(link => {
          link.classList.remove('text-[#d2d2d2]', 'hover:text-[#3212d3]');
          link.classList.add('text-[#1a1a1a]', 'hover:text-[#3212d3]');
        });
        
        // Update mobile menu button
        mobileMenuButton.classList.remove('text-[#d2d2d2]', 'hover:text-[#3212d3]');
        mobileMenuButton.classList.add('text-[#1a1a1a]', 'hover:text-[#3212d3]');
        
        // Update mobile menu border
        mobileMenu.classList.remove('border-[#d2d2d2]/20');
        mobileMenu.classList.add('border-[#e5e7eb]');
      } else {
        // Remove scrolled class for transparent background
        header.classList.remove('scrolled');
        header.classList.add('transparent');
        
        // Update text colors to light gray
        navLinks.forEach(link => {
          link.classList.remove('text-[#1a1a1a]', 'hover:text-[#3212d3]');
          link.classList.add('text-[#d2d2d2]', 'hover:text-[#3212d3]');
        });
        
        // Update mobile menu button
        mobileMenuButton.classList.remove('text-[#1a1a1a]', 'hover:text-[#3212d3]');
        mobileMenuButton.classList.add('text-[#d2d2d2]', 'hover:text-[#3212d3]');
        
        // Update mobile menu border
        mobileMenu.classList.remove('border-[#e5e7eb]');
        mobileMenu.classList.add('border-[#d2d2d2]/20');
      }
    }

    // Page-aware header behavior (body.home is set server-side in BaseLayout)
    const isHome = document.body.classList.contains('home');

    // Show/Hide header around a specific threshold
    const THRESHOLD = 150;

    function toggleHeader() {
      const scrolled = window.scrollY;
      if (scrolled > THRESHOLD) {
        header.classList.remove('opacity-0', 'pointer-events-none');
        updateHeaderOnScroll();
      } else {
        header.classList.add('opacity-0', 'pointer-events-none');
        // keep transparent style when hidden
        header.classList.add('transparent');
        header.classList.remove('scrolled');
      }
    }

    if (isHome) {
      // Home: hidden at load, reveal after threshold and apply scroll styling
      header.classList.add('transparent');
      window.addEventListener('scroll', toggleHeader);
      window.addEventListener('scroll', updateHeaderOnScroll);
      // Initial check on load
      toggleHeader();
    } else {
      // Other pages: header visible and scrolled style by default
      header.classList.remove('opacity-0', 'pointer-events-none');
      header.classList.add('scrolled');
      header.classList.remove('transparent');
      // Ensure dark text styles for nav
      navLinks.forEach(link => {
        link.classList.remove('text-[#d2d2d2]', 'hover:text-[#3212d3]');
        link.classList.add('text-[#1a1a1a]', 'hover:text-[#3212d3]');
      });
      mobileMenuButton.classList.remove('text-[#d2d2d2]', 'hover:text-[#3212d3]');
      mobileMenuButton.classList.add('text-[#1a1a1a]', 'hover:text-[#3212d3]');
      mobileMenu.classList.remove('border-[#d2d2d2]/20');
      mobileMenu.classList.add('border-[#e5e7eb]');
    }

    // Modal functionality for header buttons
    const headerModalButtons = document.querySelectorAll('.open-booking-modal');
    headerModalButtons.forEach(button => {
      button.addEventListener('click', function() {
        // Trigger the modal on the homepage if it exists
        const modal = document.getElementById('booking-modal');
        if (modal) {
          modal.classList.remove('hidden');
          document.body.style.overflow = 'hidden';
        } else {
          // Fallback to direct Cal.com link if modal doesn't exist
          window.open('https://cal.com/elharony/free-consultation', '_blank');
        }
      });
    });
  });
</script>

<style>
  #main-header.transparent {
    background: transparent;
    backdrop-filter: none;
  }
  
  #main-header.scrolled {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  }
  
  /* Smooth transitions for all elements */
  .nav-link {
    transition: color 0.3s ease;
  }
  
  #mobile-menu-button {
    transition: color 0.3s ease;
  }
  
  #mobile-menu {
    transition: border-color 0.3s ease;
  }
</style>
